<header class="bg-white border-bottom py-2 px-3 d-flex align-items-center gap-3 shadow-sm" style="height: 64px; z-index: 1000;">
    <div class="d-flex align-items-center gap-2 text-primary">
        <i class="bi bi-journal-text fs-4"></i>
        <span class="fw-bold fs-5 d-none d-md-block">ClefExplorer</span>
    </div>
    
    <div class="flex-grow-1 d-flex justify-content-center">
        <div class="input-group shadow-sm" style="max-width: 720px;">
            <span class="input-group-text bg-white border-end-0"><i class="bi bi-search text-muted"></i></span>
            <input type="text" class="form-control bg-white border-start-0 border-end-0" placeholder="Pesquisar nos logs (mensagem, correlação, exceção)..." 
                   value="@TextoPesquisa" @oninput="OnSearchInput">
            @if(!string.IsNullOrEmpty(TextoPesquisa))
            {
                <button class="btn btn-white border border-start-0" @onclick="ClearSearch"><i class="bi bi-x"></i></button>
            }
            else
            {
                <span class="input-group-text bg-white border-start-0"></span>
            }
        </div>
    </div>

    <div class="d-flex align-items-center gap-2">
            <button class="btn btn-light text-primary" @onclick="OnReload" title="Recarregar">
            <i class="bi bi-arrow-clockwise fs-5"></i>
        </button>
        <div class="dropdown">
            <button class="btn btn-light text-secondary" data-bs-toggle="dropdown"><i class="bi bi-gear fs-5"></i></button>
            <ul class="dropdown-menu dropdown-menu-end shadow">
                <li><h6 class="dropdown-header">Registros por página</h6></li>
                <li><button class="dropdown-item @(QuantidadeRegistros == 30 ? "active" : "")" @onclick="() => SetQuantidadeRegistros(30)">30 itens</button></li>
                <li><button class="dropdown-item @(QuantidadeRegistros == 50 ? "active" : "")" @onclick="() => SetQuantidadeRegistros(50)">50 itens</button></li>
                <li><button class="dropdown-item @(QuantidadeRegistros == 100 ? "active" : "")" @onclick="() => SetQuantidadeRegistros(100)">100 itens</button></li>
            </ul>
        </div>
    </div>
</header>

@code {
    [Parameter] public string TextoPesquisa { get; set; } = string.Empty;
    [Parameter] public EventCallback<string> TextoPesquisaChanged { get; set; }
    
    [Parameter] public int QuantidadeRegistros { get; set; }
    [Parameter] public EventCallback<int> QuantidadeRegistrosChanged { get; set; }

    [Parameter] public EventCallback OnReload { get; set; }

    private async Task OnSearchInput(ChangeEventArgs e)
    {
        TextoPesquisa = e.Value?.ToString() ?? string.Empty;
        await TextoPesquisaChanged.InvokeAsync(TextoPesquisa);
    }

    private async Task ClearSearch()
    {
        TextoPesquisa = string.Empty;
        await TextoPesquisaChanged.InvokeAsync(TextoPesquisa);
    }

    private async Task SetQuantidadeRegistros(int qtd)
    {
        QuantidadeRegistros = qtd;
        await QuantidadeRegistrosChanged.InvokeAsync(qtd);
    }
}
